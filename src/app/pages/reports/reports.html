<div class="min-h-screen bg-gray-100 p-8">
    <!-- Page Header -->
    <div
        class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 pb-6 border-b border-gray-300">
        <div>
            <h1 class="text-4xl font-extrabold text-gray-900 mb-2">E-Library Reports</h1>
            <p class="text-lg text-gray-600">Comprehensive analytics and statistics for your digital collection</p>
        </div>
        <button
            class="mt-6 md:mt-0 bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105">
            <span class="mr-2 text-xl">â†“</span> Export Report
        </button>
    </div>

    <!-- Loading Spinner -->
    <div *ngIf="isLoading" class="flex justify-center py-20">
        <!-- Assuming app-spinner is a visually appealing spinner component -->
        <app-spinner></app-spinner>
    </div>

    <!-- Error Message -->
    <div *ngIf="error" class="bg-red-50 border border-red-400 text-red-800 px-6 py-4 rounded-xl relative shadow-md mb-8"
        role="alert">
        <strong class="font-bold text-lg">Error:</strong> <span class="block sm:inline ml-2">{{ error }}</span>
        <span class="absolute top-0 bottom-0 right-0 px-4 py-3">
            <svg class="fill-current h-6 w-6 text-red-500" role="button" xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20">
                <title>Close</title>
                <path
                    d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z" />
            </svg>
        </span>
    </div>

    <!-- Main Report Content -->
    <div *ngIf="!isLoading && !error && metrics">
        <!-- Performance Metrics -->
        <h2 class="text-3xl font-bold text-gray-800 mb-6">Performance Metrics</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
            <!-- Most Viewed -->
            <div class="bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-shadow duration-300 overflow-hidden">
                <div
                    class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-extrabold text-lg p-5 rounded-t-2xl">
                    Most Viewed</div>
                <ul class="p-5 space-y-4">
                    <li *ngFor="let item of metrics.mostViewed"
                        class="flex justify-between items-center border-b border-gray-200 pb-2 last:border-b-0 last:pb-0">
                        <p class="text-gray-700 text-base font-medium">{{ item.title }}</p>
                        <span class="bg-blue-100 text-blue-700 text-sm font-bold px-3 py-1 rounded-full shadow-sm">{{
                            item.viewCount }} views</span>
                    </li>
                </ul>
            </div>
            <!-- Active Categories -->
            <div class="bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-shadow duration-300 overflow-hidden">
                <div
                    class="bg-gradient-to-r from-green-500 to-teal-600 text-white font-extrabold text-lg p-5 rounded-t-2xl">
                    Active Categories</div>
                <ul class="p-5 space-y-4">
                    <li *ngFor="let item of metrics.activeCategories"
                        class="flex justify-between items-center border-b border-gray-200 pb-2 last:border-b-0 last:pb-0">
                        <p class="text-gray-700 text-base font-medium">{{ item.categoryName }}</p>
                        <span class="bg-green-100 text-green-700 text-sm font-bold px-3 py-1 rounded-full shadow-sm">{{
                            item.resourceCount }} resources</span>
                    </li>
                </ul>
            </div>
            <!-- Top Authors -->
            <div class="bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-shadow duration-300 overflow-hidden">
                <div
                    class="bg-gradient-to-r from-orange-500 to-red-600 text-white font-extrabold text-lg p-5 rounded-t-2xl">
                    Top Authors</div>
                <ul class="p-5 space-y-4">
                    <li *ngFor="let item of metrics.topAuthors"
                        class="flex justify-between items-center border-b border-gray-200 pb-2 last:border-b-0 last:pb-0">
                        <p class="text-gray-700 text-base font-medium">{{ item.authorName }}</p>
                        <span
                            class="bg-yellow-100 text-yellow-700 text-sm font-bold px-3 py-1 rounded-full shadow-sm">{{
                            item.resourceCount }} works</span>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Recent Activity -->
        <h2 class="text-3xl font-bold text-gray-800 mb-6">Recent Activity</h2>
        <div class="bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-shadow duration-300 overflow-hidden">
            <div class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-extrabold text-lg p-5">Recent
                Uploads</div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col"
                                class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">
                                Title</th>
                            <th scope="col"
                                class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">
                                Category</th>
                            <th scope="col"
                                class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">
                                Type</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <tr *ngFor="let item of recentUploads" class="hover:bg-gray-50 transition-colors duration-150">
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ item.title }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="bg-cyan-100 text-cyan-800 text-xs font-semibold px-3 py-1 rounded-full">{{
                                    item.categoryName }}</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-3 py-1 text-xs font-semibold rounded-full"
                                    [ngClass]="{'bg-red-100 text-red-800': item.resourceType === 1, 'bg-blue-100 text-blue-800': item.resourceType !== 1 && item.resourceType !== 0, 'bg-indigo-100 text-indigo-800': item.resourceType === 0}">
                                    <span [ngSwitch]="item.resourceType">
                                        <span *ngSwitchCase="0">Book</span>
                                        <span *ngSwitchCase="1">PDF</span>
                                        <span *ngSwitchCase="2">Video</span>
                                        <span *ngSwitchCase="3">Article</span>
                                        <span *ngSwitchDefault>Other</span>
                                    </span>
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>