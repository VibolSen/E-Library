<div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6 sm:p-10 flex items-center justify-center">
    <div
        class="w-full max-w-4xl bg-white rounded-xl shadow-2xl p-8 sm:p-10 border border-blue-200 animate-fade-in-down">
        <h1 class="text-4xl font-extrabold text-gray-900 mb-8 text-center">
            {{ isEditMode ? 'Edit Your Book' : 'Add a New Book' }}
        </h1>

        <form (ngSubmit)="saveBook()" #bookForm="ngForm" class="space-y-6">
            <!-- Title -->
            <div>
                <label for="title" class="block text-sm font-semibold text-gray-700 mb-1">Book Title</label>
                <input type="text" id="title" name="title" [(ngModel)]="book.title" required
                    class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm py-2.5 px-4 text-gray-800 placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 ease-in-out"
                    placeholder="e.g., The Secret Garden">
            </div>

            <!-- Category -->
            <div>
                <label for="category" class="block text-sm font-semibold text-gray-700 mb-1">Category</label>
                <div class="relative">
                    <select id="category" name="category" [(ngModel)]="book.categoryId" required
                        class="block appearance-none w-full border-gray-300 rounded-lg shadow-sm py-2.5 px-4 pr-10 text-gray-800 focus:outline-none focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 ease-in-out">
                        <option [value]="null" disabled selected>-- Select a Category --</option>
                        <option *ngFor="let category of categories" [value]="category.id">{{ category.name }}</option>
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-700">
                        <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                            <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
                        </svg>
                    </div>
                </div>
            </div>

            <!-- File Upload Section -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-1">eBook File (PDF, EPUB)</label>
                    <input type="file" class="hidden" #ebookFileInput (change)="onEbookFileSelected($event)">
                    <button (click)="ebookFileInput.click()" type="button"
                        class="w-full bg-blue-100 text-blue-700 font-medium py-2.5 px-4 rounded-lg border border-blue-200 hover:bg-blue-200 transition-colors duration-200 ease-in-out flex items-center justify-center space-x-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M8 4a3 3 0 00-3 3v4a5 5 0 0010 0V7a1 1 0 112 0v4a7 7 0 11-14 0V7a5 5 0 0110 0v4a3 3 0 11-6 0V7a1 1 0 012 0v4a1 1 0 102 0V7a3 3 0 00-3-3z"
                                clip-rule="evenodd" />
                        </svg>
                        <span>Upload eBook</span>
                    </button>
                    <p class="text-xs text-gray-500 mt-2 text-center">Max file size: 100 MB.</p>
                    <p *ngIf="selectedEbookFile" class="text-sm text-gray-600 mt-2 truncate text-center">
                        Selected: <span class="font-medium text-blue-600">{{ selectedEbookFile.name }}</span>
                    </p>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-1">Cover Image</label>
                    <input type="file" class="hidden" #coverImageInput (change)="onFileSelected($event)">
                    <button (click)="coverImageInput.click()" type="button"
                        class="w-full bg-blue-100 text-blue-700 font-medium py-2.5 px-4 rounded-lg border border-blue-200 hover:bg-blue-200 transition-colors duration-200 ease-in-out flex items-center justify-center space-x-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-4 4 4 4-4v4zm-3-9a1 1 0 11-2 0 1 1 0 012 0z"
                                clip-rule="evenodd" />
                        </svg>
                        <span>Upload Cover</span>
                    </button>
                    <p class="text-xs text-gray-500 mt-2 text-center">Recommended: JPEG, PNG.</p>
                    <p *ngIf="selectedFile" class="text-sm text-gray-600 mt-2 truncate text-center">
                        Selected: <span class="font-medium text-blue-600">{{ selectedFile.name }}</span>
                    </p>
                </div>
            </div>

            <!-- Description -->
            <div>
                <label for="description" class="block text-sm font-semibold text-gray-700 mb-1">Description</label>
                <textarea id="description" name="description" [(ngModel)]="book.description" rows="4"
                    class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm py-2.5 px-4 text-gray-800 placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 ease-in-out"
                    placeholder="A brief summary of the book's content..."></textarea>
            </div>

            <!-- Author & Publisher -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="author" class="block text-sm font-semibold text-gray-700 mb-1">Author</label>
                    <input type="text" id="author" name="author" [(ngModel)]="book.author" required
                        class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm py-2.5 px-4 text-gray-800 placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 ease-in-out"
                        placeholder="e.g., Jane Doe">
                </div>
                <div>
                    <label for="publisher" class="block text-sm font-semibold text-gray-700 mb-1">Publisher</label>
                    <input type="text" id="publisher" name="publisher" [(ngModel)]="book.publisher"
                        class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm py-2.5 px-4 text-gray-800 placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 ease-in-out"
                        placeholder="e.g., Penguin Random House">
                </div>
            </div>

            <!-- PublishedDate & ISBN -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="publishedDate" class="block text-sm font-semibold text-gray-700 mb-1">Published
                        Date</label>
                    <input type="date" id="publishedDate" name="publishedDate" [(ngModel)]="book.publishedDate"
                        class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm py-2.5 px-4 text-gray-800 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 ease-in-out">
                </div>
                <div>
                    <label for="isbn" class="block text-sm font-semibold text-gray-700 mb-1">ISBN</label>
                    <input type="text" id="isbn" name="isbn" [(ngModel)]="book.isbn"
                        class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm py-2.5 px-4 text-gray-800 placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 ease-in-out"
                        placeholder="e.g., 978-3-16-148410-0">
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-col sm:flex-row justify-end gap-4 pt-6 border-t border-gray-200 mt-8">
                <a routerLink="/manage-books"
                    class="w-full sm:w-auto bg-gray-200 text-gray-800 font-bold py-3 px-6 rounded-lg hover:bg-gray-300 transition-colors duration-200 ease-in-out text-center">
                    Back to List
                </a>
                <button type="submit" [disabled]="!bookForm.form.valid || isLoading"
                    class="w-full sm:w-auto bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors duration-200 ease-in-out disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center space-x-2">
                    <span *ngIf="!isLoading">{{ isEditMode ? 'Save Changes' : 'Create Book' }}</span>
                    <span *ngIf="isLoading" class="flex items-center">
                        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg"
                            fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
                            </circle>
                            <path class="opacity-75" fill="currentColor"
                                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                            </path>
                        </svg>
                        Saving...
                    </span>
                </button>
            </div>
        </form>
    </div>
</div>

<style>
    @keyframes fade-in-down {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-fade-in-down {
        animation: fade-in-down 0.6s ease-out forwards;
    }
</style>